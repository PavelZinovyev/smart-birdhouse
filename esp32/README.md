# ESP32 — умная кормушка (контроллер)

Фирмвар для ESP32: датчики (расстояние, температура/влажность), управление питанием Raspberry Pi и сигналы старта/остановки записи.

## Оборудование

- **VL53L0X** — дальность до объекта (определение птицы в кормушке)
- **SHT31** — температура и влажность
- **GPIO** — сигналы к Pi, управление питанием, LED

## Пины (ESP32)

| Пин | Назначение |
|-----|------------|
| 21  | I2C SDA    |
| 20  | I2C SCL    |
| 6   | `PI_SIGNAL_PIN` — выход: HIGH = команда Pi начать запись |
| 4   | `PI_READY_PIN` — вход: HIGH = Pi готов/пишет, LOW = можно выключать |
| 5   | `PI_POWER_PIN` — выход на MOSFET: LOW = питание Pi включено |
| 7   | LED        |

## Логика (state machine)

1. **IDLE** — опрос расстояния; при расстоянии < 50 мм несколько раз подряд → «птица», включение питания Pi.
2. **POWERING_PI** — ожидание `PI_READY_PIN == HIGH`, затем на `PI_SIGNAL_PIN` даётся HIGH (старт записи).
3. **RECORDING** — ожидание `PI_READY_PIN == LOW` (Pi закончил запись).
4. **COOLDOWN** — пауза ~5 с, затем переход в IDLE.

## Файлы

- `lib/main.py` — основной скетч (Arduino/C++; по факту C++, имя файла может быть `.ino`/`.cpp` в зависимости от сборки).

## Сборка и загрузка

Используется среда Arduino или PlatformIO. Подключить библиотеки: **Adafruit SHT31**, **Adafruit VL53L0X**, **Wire**. Загрузить скетч на ESP32 через USB.
